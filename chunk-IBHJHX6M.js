import{J as c,O as a,R as q,h as C,ha as x,ma as k,na as z,oa as T,qa as Q,ta as I}from"./chunk-R5PFEGJ7.js";var m=(()=>{let e=class e{get context(){return this._context}get canvas(){return this._canvas}get width(){return this.canvas.width}get height(){return this.canvas.height}setUpCanvas(t){let s=t.getContext("2d");this._canvas=t,s&&(this._context=s)}clearCanvas(){this.context.clearRect(0,0,this.width,this.height)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var d=function(i){return i.Vertical="vertical",i.Horizontal="horizontal",i}(d||{});var f=(()=>{let e=class e{constructor(){this.verticalCoordinates=["1","2","3","4","5","6","7","8"],this.horizontalCoordinates=["a","b","c","d","e","f","g","h"],this._isWhiteOnBottom=new C(!1),this.isWhiteOnBottom$=this._isWhiteOnBottom.asObservable()}get isWhiteOnBottom(){return this._isWhiteOnBottom.getValue()}set isWhiteOnBottom(t){this._isWhiteOnBottom.next(t)}getEmptyBoard(){return{pieces:new Array(this.verticalCoordinates.length).fill(null).map(()=>new Array(this.horizontalCoordinates.length).fill(null))}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var B=(()=>{let e=class e{constructor(t){this.chessBoardConfig=t}getCoordinatesOrder(t){return t===d.Horizontal?this.chessBoardConfig.isWhiteOnBottom?[...this.chessBoardConfig.horizontalCoordinates]:[...this.chessBoardConfig.horizontalCoordinates].reverse():this.chessBoardConfig.isWhiteOnBottom?[...this.chessBoardConfig.verticalCoordinates].reverse():[...this.chessBoardConfig.verticalCoordinates]}};e.\u0275fac=function(s){return new(s||e)(a(f))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var p=(()=>{let e=class e{constructor(t){this.chessBoardCanvas=t}set cursor(t){this.chessBoardCanvas.canvas.style.cursor=t}getCursorPoint(t){let r=this.chessBoardCanvas.canvas.getBoundingClientRect();return{x:t.clientX-r.left,y:t.clientY-r.top}}getSquareSize(){return this.chessBoardCanvas.width/8}getSquareCoordinates(t){let s=this.getSquareSize();return{vertical:Math.floor(t.y/s),horizontal:Math.floor(t.x/s)}}};e.\u0275fac=function(s){return new(s||e)(a(m))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var v=function(i){return i.Classic="classic",i.Glass="glass",i}(v||{});var u=(()=>{let e=class e{constructor(){this._themes={[v.Classic]:{lightSquareColor:"rgb(237, 238, 209)",darkSquareColor:"rgb(119, 152, 83)"},[v.Glass]:{lightSquareColor:"rgb(104, 113, 129)",darkSquareColor:"rgb(40, 47, 59)"}},this._currentTheme=new C(this._themes[v.Classic]),this.currentTheme$=this._currentTheme.asObservable()}get currentTheme(){return this._currentTheme.getValue()}set currentTheme(t){this._currentTheme.next(this._themes[t])}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var _=(()=>{let e=class e{constructor(t,s,r){this.chessBoardCanvas=t,this.canvasHelper=s,this.chessBoardThemes=r}draw(t){let s=this.chessBoardThemes.currentTheme,r=this.isDarkSquare(t.vertical+t.horizontal)?s.lightSquareColor:s.darkSquareColor,o=this.chessBoardCanvas.context,l=this.canvasHelper.getSquareSize();o.fillStyle=r,o.textBaseline="top",o.fillRect(t.horizontal*l,t.vertical*l,l,l)}isDarkSquare(t){return t%2===0}};e.\u0275fac=function(s){return new(s||e)(a(m),a(p),a(u))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var O=(()=>{let e=class e{constructor(t,s,r,o){this.chessBoardCanvas=t,this.canvasHelper=s,this.chessBoardThemes=r,this.coordinatesHelper=o}draw(t){let s=t.horizontal===0,r=t.vertical===7;s&&this.drawVerticalCoordinate(t),r&&this.drawHorizontalCoordinate(t)}drawVerticalCoordinate(t){let s=this.chessBoardCanvas.context,r=this.canvasHelper.getSquareSize(),o=this.coordinatesHelper.getCoordinatesOrder(d.Vertical)[t.vertical],l=t.horizontal*r+r/16,j=t.vertical*r+r/16;s.font=this.getFont(),s.fillStyle=this.getColor(t),s.textBaseline="top",s.textAlign="left",s.fillText(o,l,j)}drawHorizontalCoordinate(t){let s=this.chessBoardCanvas.context,r=this.canvasHelper.getSquareSize(),o=this.coordinatesHelper.getCoordinatesOrder(d.Horizontal)[t.horizontal],l=t.horizontal*r+r-r/16,j=t.vertical*r+r-r/16;s.font=this.getFont(),s.fillStyle=this.getColor(t),s.textBaseline="alphabetic",s.textAlign="right",s.fillText(o,l,j)}getFont(){return`bold ${this.canvasHelper.getSquareSize()/4.5}px Arial`}getColor(t){let s=this.chessBoardThemes.currentTheme;return this.isDarkSquare(t.vertical+t.horizontal)?s.darkSquareColor:s.lightSquareColor}isDarkSquare(t){return t%2===0}};e.\u0275fac=function(s){return new(s||e)(a(m),a(p),a(u),a(B))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var F=(()=>{let e=class e{constructor(t){this.chessBoardConfig=t}getChessBoardState(t){return t.split(" ")[0].split("/").reduce((o,l,j)=>(this.getPiecesRow(l).forEach((K,$)=>{K&&(o.pieces[j][$]=K)}),o),this.chessBoardConfig.getEmptyBoard())}getPiecesRow(t){return t.split("").reduce((r,o)=>!isNaN(Number(o))?[...r,...Array(Number(o)).fill(null)]:[...r,o],[])}};e.\u0275fac=function(s){return new(s||e)(a(f))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var g=(()=>{let e=class e{constructor(t,s){this.fenStringHelper=t,this.chessBoardConfig=s}get board(){return this._board}set board(t){this._board=t}initialize(t){this.board=this.fenStringHelper.getChessBoardState(t)}getPiece(t){let s=[...this.board.pieces];return this.chessBoardConfig.isWhiteOnBottom||(s=s.reverse().map(r=>[...r].reverse())),s[t.vertical][t.horizontal]}};e.\u0275fac=function(s){return new(s||e)(a(F),a(f))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var w=function(i){return i.Classic="classic",i.Metal="metal",i}(w||{});var n=function(i){return i.R="R",i.N="N",i.B="B",i.Q="Q",i.K="K",i.P="P",i.r="r",i.n="n",i.b="b",i.q="q",i.k="k",i.p="p",i}(n||{});var b=(()=>{let e=class e{constructor(){this._themes={[w.Classic]:{[n.R]:"assets/chess-pieces-themes/classic/classic_piece_r_light.svg",[n.N]:"assets/chess-pieces-themes/classic/classic_piece_n_light.svg",[n.B]:"assets/chess-pieces-themes/classic/classic_piece_b_light.svg",[n.Q]:"assets/chess-pieces-themes/classic/classic_piece_q_light.svg",[n.K]:"assets/chess-pieces-themes/classic/classic_piece_k_light.svg",[n.P]:"assets/chess-pieces-themes/classic/classic_piece_p_light.svg",[n.r]:"assets/chess-pieces-themes/classic/classic_piece_r_dark.svg",[n.n]:"assets/chess-pieces-themes/classic/classic_piece_n_dark.svg",[n.b]:"assets/chess-pieces-themes/classic/classic_piece_b_dark.svg",[n.q]:"assets/chess-pieces-themes/classic/classic_piece_q_dark.svg",[n.k]:"assets/chess-pieces-themes/classic/classic_piece_k_dark.svg",[n.p]:"assets/chess-pieces-themes/classic/classic_piece_p_dark.svg"},[w.Metal]:{[n.R]:"assets/chess-pieces-themes/metal/metal_piece_r_light.png",[n.N]:"assets/chess-pieces-themes/metal/metal_piece_n_light.png",[n.B]:"assets/chess-pieces-themes/metal/metal_piece_b_light.png",[n.Q]:"assets/chess-pieces-themes/metal/metal_piece_q_light.png",[n.K]:"assets/chess-pieces-themes/metal/metal_piece_k_light.png",[n.P]:"assets/chess-pieces-themes/metal/metal_piece_p_light.png",[n.r]:"assets/chess-pieces-themes/metal/metal_piece_r_dark.png",[n.n]:"assets/chess-pieces-themes/metal/metal_piece_n_dark.png",[n.b]:"assets/chess-pieces-themes/metal/metal_piece_b_dark.png",[n.q]:"assets/chess-pieces-themes/metal/metal_piece_q_dark.png",[n.k]:"assets/chess-pieces-themes/metal/metal_piece_k_dark.png",[n.p]:"assets/chess-pieces-themes/metal/metal_piece_p_dark.png"}},this._currentTheme=new C(this._themes[v.Classic]),this.currentTheme$=this._currentTheme.asObservable()}get currentTheme(){return this._currentTheme.getValue()}set currentTheme(t){this._currentTheme.next(this._themes[t])}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var M=(()=>{let e=class e{constructor(t,s,r,o){this.chessGameState=t,this.canvasHelper=s,this.chessBoardCanvas=r,this.chessPiecesTheme=o}draw(t){let s=this.chessGameState.getPiece(t);if(!s)return;let r=this.canvasHelper.getSquareSize(),o=new Image(r,r);o.onload=()=>{this.chessBoardCanvas.context.drawImage(o,t.horizontal*r,t.vertical*r,r,r)},o.src=this.chessPiecesTheme.currentTheme[s]}};e.\u0275fac=function(s){return new(s||e)(a(g),a(p),a(m),a(b))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var W=(()=>{let e=class e{constructor(t,s,r){this.drawSquareBackground=t,this.drawSquareCoordinates=s,this.drawSquarePiece=r}draw(t){this.drawSquareBackground.draw(t),this.drawSquareCoordinates.draw(t),this.drawSquarePiece.draw(t)}};e.\u0275fac=function(s){return new(s||e)(a(_),a(O),a(M))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var R=(()=>{let e=class e{constructor(t,s){this.coordinatesHelper=t,this.drawSquare=s}execute(){this.verticalCoordinates=this.coordinatesHelper.getCoordinatesOrder(d.Vertical),this.horizontalCoordinates=this.coordinatesHelper.getCoordinatesOrder(d.Horizontal),this.verticalCoordinates.forEach((t,s)=>{this.horizontalCoordinates.forEach((r,o)=>{this.drawSquare.draw({vertical:s,horizontal:o})})})}};e.\u0275fac=function(s){return new(s||e)(a(B),a(W))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var E=(()=>{let e=class e{constructor(t,s){this.chessBoardCanvas=t,this.drawChessBoard=s}execute(t){this.chessBoardCanvas.setUpCanvas(t),this.chessBoardCanvas.clearCanvas(),this.drawChessBoard.execute()}};e.\u0275fac=function(s){return new(s||e)(a(m),a(R))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var D=(()=>{let e=class e{constructor(t,s,r){this.chessBoardConfig=t,this.chessPiecesTheme=s,this.chessBoardThemes=r}execute(t){this.chessBoardConfig.isWhiteOnBottom=t.isWhiteOnBottom,this.chessPiecesTheme.currentTheme=t.chessPiecesTheme,this.chessBoardThemes.currentTheme=t.chessBoardTheme}};e.\u0275fac=function(s){return new(s||e)(a(f),a(b),a(u))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var A=(()=>{let e=class e{constructor(t,s,r){this.chessBoardCanvas=t,this.canvasHelper=s,this.chessBoardThemes=r,this.frameWidth=2}draw(t,s="white"){let r=this.chessBoardCanvas.context,o=this.canvasHelper.getSquareSize();r.beginPath(),r.strokeStyle=s,r.lineWidth=this.frameWidth,r.strokeRect(t.horizontal*o+this.frameWidth/2,t.vertical*o+this.frameWidth/2,o-this.frameWidth,o-this.frameWidth),r.closePath()}clear(t){let s=this.chessBoardThemes.currentTheme,r=this.isDarkSquare(t.vertical+t.horizontal)?s.lightSquareColor:s.darkSquareColor;this.draw(t,r)}isDarkSquare(t){return t%2===0}};e.\u0275fac=function(s){return new(s||e)(a(m),a(p),a(u))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var G=(()=>{let e=class e{constructor(t,s,r,o){this.chessBoardCanvas=t,this.drawSquareFrame=s,this.canvasHelper=r,this.chessGameState=o,this._previousSquare=null}get previousSquare(){return this._previousSquare}set previousSquare(t){this._previousSquare=t}execute(){let t=this.chessBoardCanvas.canvas;t.addEventListener("mouseenter",()=>{t.addEventListener("mousemove",this.handleMouseMove.bind(this))}),t.addEventListener("mouseleave",()=>{t.removeEventListener("mousemove",this.handleMouseMove.bind(this)),this.previousSquare&&this.drawSquareFrame.clear(this.previousSquare)})}handleMouseMove(t){let s=this.canvasHelper.getCursorPoint(t),r=this.canvasHelper.getSquareCoordinates(s),o=this.chessGameState.getPiece(r);this.isSquareChanged(r)&&(this.drawSquareFrame.draw(r),this.canvasHelper.cursor=o?"pointer":"default",this.previousSquare&&this.drawSquareFrame.clear(this.previousSquare),this.previousSquare=r)}isSquareChanged(t){return t.vertical!==this.previousSquare?.vertical||t.horizontal!==this.previousSquare?.horizontal}};e.\u0275fac=function(s){return new(s||e)(a(m),a(A),a(p),a(g))},e.\u0275prov=c({token:e,factory:e.\u0275fac});let i=e;return i})();var N=(()=>{let e=class e{constructor(t,s,r,o){this.setUpAccount=t,this.initializeCanvasView=s,this.chessGameState=r,this.initializeHoverEffect=o,this.initialFenString="rnbq4/ppp1k1pp/3b4/3ppp2/2PPPPP1/5N2/PP5P/RNBQKB1R b KQ c3 0 6"}ngOnInit(){this.setUpAccount.execute({isWhiteOnBottom:!0,chessPiecesTheme:w.Classic,chessBoardTheme:v.Glass})}ngAfterViewInit(){let t=document.getElementById("chess-board-canvas");this.chessGameState.initialize(this.initialFenString),this.initializeCanvasView.execute(t),this.initializeHoverEffect.execute()}};e.\u0275fac=function(s){return new(s||e)(x(D),x(E),x(g),x(G))},e.\u0275cmp=q({type:e,selectors:[["ca-chess-board"]],standalone:!0,features:[Q([m,E,R,f,F,B,D,b,u,G,A,p,_,O,W,g,M]),I],decls:2,vars:0,consts:[[1,"canvas-container"],["id","chess-board-canvas","width","600","height","600"]],template:function(s,r){s&1&&(k(0,"div",0),T(1,"canvas",1),z())},styles:[".canvas-container[_ngcontent-%COMP%]{width:100%;height:100%}.canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;height:100%}"]});let i=e;return i})();var Qe=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=q({type:e,selectors:[["app-game"]],standalone:!0,features:[I],decls:3,vars:0,consts:[[1,"game-screen"],[1,"chess-board-container"]],template:function(s,r){s&1&&(k(0,"div",0)(1,"div",1),T(2,"ca-chess-board"),z()())},dependencies:[N],styles:[".game-screen[_ngcontent-%COMP%]{width:100%;height:100%;min-height:100vh;display:flex;align-items:center;justify-content:center}.game-screen[_ngcontent-%COMP%]   .chess-board-container[_ngcontent-%COMP%]{width:600px;height:600px}"]});let i=e;return i})();export{Qe as GameComponent};
